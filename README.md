# Codex - Система управления событиями

Система календаря событий для настольных игр с авторизацией пользователей.

## Новые возможности

✅ **Система пользователей** - регистрация и авторизация  
✅ **Долгосрочное хранение данных** - серверная база данных  
✅ **Контроль доступа** - только создатель может редактировать/удалять события  
✅ **Безопасность** - токены авторизации с истечением срока действия  

## Установка и запуск

### 1. Установка зависимостей

```bash
# Переходим в папку проекта
cd D:\Git_Projects\Codex

# Устанавливаем зависимости
npm install
```

### 2. Запуск сервера

```bash
# Запуск сервера разработки
npm start

# Или для разработки с автоперезагрузкой
npm run dev
```

Сервер запустится на `http://localhost:3000`

### 3. Открытие сайта

Откройте браузер и перейдите по адресу: `http://localhost:3000`

## Использование

### Первый запуск

1. Откройте `http://localhost:3000`
2. Нажмите "Начать приключение"
3. Зарегистрируйтесь (создайте новый аккаунт)
4. Или войдите с существующими данными

### Работа с событиями

**Создание события:**
- Перейдите в раздел "Календарь"
- Нажмите "Добавить событие" или кликните на дату
- Заполните форму и сохраните

**Редактирование события:**
- Только создатель может редактировать свои события
- В списке событий нажмите иконку редактирования
- Внесите изменения и сохраните

**Удаление события:**
- Только создатель может удалить свое событие
- Нажмите иконку корзины в списке событий
- Подтвердите удаление

### Визуальные отличия

- **Ваши события** отмечены синей полосой слева
- **Чужие события** можно только просматривать
- В календаре ваши события имеют белую границу

## Структура файлов

```
D:\Git_Projects\Codex\
├── server.js              # Основной серверный файл
├── package.json            # Зависимости проекта
├── data/                   # Папка с данными (создается автоматически)
│   ├── users.json         # База пользователей
│   ├── events.json        # База событий
│   └── sessions.json      # Активные сессии
├── js/
│   ├── auth.js            # Система авторизации (клиент)
│   └── calendar.js        # Календарь с авторизацией
├── auth.html              # Страница входа/регистрации
├── content.html           # Основная страница (требует авторизации)
├── index.html             # Главная страница
└── partials/
    └── calendar.html      # Страница календаря
```

## API Endpoints

### Авторизация
- `POST /api/register` - Регистрация пользователя
- `POST /api/login` - Вход в систему
- `POST /api/logout` - Выход из системы
- `GET /api/user` - Информация о текущем пользователе

### События
- `GET /api/events` - Получить все события
- `POST /api/events` - Создать событие
- `PUT /api/events/:id` - Обновить событие (только создатель)
- `DELETE /api/events/:id` - Удалить событие (только создатель)

## Безопасность

### Аутентификация
- Пароли хешируются с помощью SHA-256
- Токены сессий автоматически истекают через 7 дней
- Проверка токенов на каждом запросе

### Авторизация
- Каждое событие привязано к создателю
- Проверка прав доступа на сервере
- Клиентская проверка для UI

### Валидация данных
- Проверка всех входящих данных
- Санитизация пользовательского ввода
- Ограничения на длину полей

## Устранение неполадок

### Сервер не запускается
```bash
# Проверьте, установлены ли зависимости
npm install

# Проверьте, свободен ли порт 3000
netstat -an | findstr :3000
```

### Ошибки авторизации
- Очистите localStorage в браузере
- Перезапустите сервер
- Проверьте файл `data/sessions.json`

### Данные не сохраняются
- Убедитесь, что папка `data/` создана
- Проверьте права доступа к папке
- Посмотрите логи сервера в консоли

## Технические детали

### Стек технологий
- **Backend:** Node.js + Express
- **Frontend:** Vanilla JavaScript
- **Хранение:** JSON файлы
- **Стили:** Custom CSS

### Особенности реализации
- Файловая система вместо базы данных (для простоты)
- Сессии хранятся в памяти сервера
- Автоочистка просроченных сессий каждый час

## Дальнейшее развитие

Возможные улучшения:
- [ ] Миграция на настоящую БД (PostgreSQL/MongoDB)
- [ ] Система ролей и прав доступа
- [ ] Уведомления о событиях
- [ ] Экспорт в календарные форматы
- [ ] Мобильное приложение
- [ ] Групповые календари

## Поддержка

При возникновении проблем:
1. Проверьте логи сервера в консоли
2. Откройте консоль разработчика в браузере
3. Убедитесь, что сервер запущен на порту 3000
4. Проверьте подключение к интернету (для загрузки шрифтов)

---

© 2025 Codex Team. Проект с открытым исходным кодом.
