<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ Codex</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-button {
            display: inline-block;
            margin: 10px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.3s;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ –¢–µ—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ Codex</h1>
        
        <div id="status" class="status warning">
            –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤...
        </div>
        
        <h2>–ë—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã</h2>
        <div>
            <a href="#" class="test-button" onclick="testMainPage()">–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</a>
            <a href="#" class="test-button" onclick="testCoreIntro()">Core: –í–≤–µ–¥–µ–Ω–∏–µ</a>
            <a href="#" class="test-button" onclick="testHeroes()">Heroes: –ü–µ—Ä—Å–æ–Ω–∞–∂–∏</a>
            <a href="#" class="test-button" onclick="testMortals()">Mortals</a>
            <a href="#" class="test-button" onclick="testDust()">Dust</a>
            <a href="#" class="test-button" onclick="testProject()">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
            <a href="#" class="test-button" onclick="testContacts()">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
        </div>
        
        <h2>–¢–µ—Å—Ç –∞–Ω–∏–º–∞—Ü–∏–π</h2>
        <div>
            <a href="#" class="test-button" onclick="setAnimation('fade')">Fade</a>
            <a href="#" class="test-button" onclick="setAnimation('slide-left')">Slide</a>
            <a href="#" class="test-button" onclick="setAnimation('scale')">Scale</a>
            <a href="#" class="test-button" onclick="setAnimation('flip')">Flip</a>
            <a href="#" class="test-button" onclick="enableRandomAnimations()">Random</a>
        </div>
        
        <h2>–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</h2>
        <div>
            <a href="#" class="test-button" onclick="runDiagnostics()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É</a>
            <a href="#" class="test-button" onclick="showDebugInfo()">Debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</a>
            <a href="#" class="test-button" onclick="reloadCurrentPage()">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
        </div>
        
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤</h2>
        <div id="test-results">
            <p>–¢–µ—Å—Ç—ã –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã</p>
        </div>
        
        <h2>–õ–æ–≥ –∫–æ–Ω—Å–æ–ª–∏</h2>
        <div id="console-log" style="background: #f8f9fa; padding: 15px; border-radius: 4px; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto;">
            –õ–æ–≥ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å...
        </div>
    </div>

    <script>
        // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º console.log –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        function addToLog(type, message) {
            const logElement = document.getElementById('console-log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.style.marginBottom = '5px';
            logEntry.style.color = type === 'error' ? '#dc3545' : type === 'warn' ? '#856404' : '#333';
            logEntry.innerHTML = `<span style="color: #666;">[${timestamp}]</span> ${message}`;
            logElement.appendChild(logEntry);
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLog('log', args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToLog('error', '‚ùå ' + args.join(' '));
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToLog('warn', '‚ö†Ô∏è ' + args.join(' '));
        };

        // –§—É–Ω–∫—Ü–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function updateStatus(message, type = 'warning') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function addTestResult(name, success, details = '') {
            const results = document.getElementById('test-results');
            const result = document.createElement('div');
            result.style.padding = '8px';
            result.style.margin = '5px 0';
            result.style.borderRadius = '4px';
            result.style.background = success ? '#d4edda' : '#f8d7da';
            result.style.color = success ? '#155724' : '#721c24';
            result.innerHTML = `
                <strong>${success ? '‚úÖ' : '‚ùå'} ${name}</strong>
                ${details ? `<br><small>${details}</small>` : ''}
            `;
            results.appendChild(result);
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ ContentLoader
        function checkContentLoader() {
            if (typeof window.ContentLoader !== 'undefined') {
                updateStatus('ContentLoader –Ω–∞–π–¥–µ–Ω!', 'success');
                addTestResult('ContentLoader', true, '–ö–ª–∞—Å—Å –¥–æ—Å—Ç—É–ø–µ–Ω –≤ window.ContentLoader');
                return true;
            } else {
                updateStatus('ContentLoader –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                addTestResult('ContentLoader', false, '–ö–ª–∞—Å—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ window.ContentLoader');
                return false;
            }
        }

        // –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        async function testMainPage() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/main.html');
                addTestResult('–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞', false, error.message);
            }
        }

        async function testCoreIntro() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/core/1_intro.html');
                addTestResult('Core: –í–≤–µ–¥–µ–Ω–∏–µ', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('Core: –í–≤–µ–¥–µ–Ω–∏–µ', false, error.message);
            }
        }

        async function testHeroes() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/heroes/1_char.html');
                addTestResult('Heroes: –ü–µ—Ä—Å–æ–Ω–∞–∂–∏', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('Heroes: –ü–µ—Ä—Å–æ–Ω–∞–∂–∏', false, error.message);
            }
        }

        async function testMortals() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/mortals/mortals1.html');
                addTestResult('Mortals', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('Mortals', false, error.message);
            }
        }

        async function testDust() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/dust/dust1.html');
                addTestResult('Dust', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('Dust', false, error.message);
            }
        }

        async function testProject() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/project.html');
                addTestResult('–û –ø—Ä–æ–µ–∫—Ç–µ', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('–û –ø—Ä–æ–µ–∫—Ç–µ', false, error.message);
            }
        }

        async function testContacts() {
            if (!checkContentLoader()) return;
            try {
                await window.ContentLoader.loadContent('partials/contacts.html');
                addTestResult('–ö–æ–Ω—Ç–∞–∫—Ç—ã', true, '–£—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('–ö–æ–Ω—Ç–∞–∫—Ç—ã', false, error.message);
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π
        function setAnimation(type) {
            if (!checkContentLoader()) return;
            try {
                window.ContentLoader.setAnimationType(type);
                addTestResult(`–ê–Ω–∏–º–∞—Ü–∏—è: ${type}`, true, '–¢–∏–ø –∞–Ω–∏–º–∞—Ü–∏–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
            } catch (error) {
                addTestResult(`–ê–Ω–∏–º–∞—Ü–∏—è: ${type}`, false, error.message);
            }
        }

        function enableRandomAnimations() {
            if (!checkContentLoader()) return;
            try {
                window.ContentLoader.enableRandomAnimations();
                addTestResult('Random –∞–Ω–∏–º–∞—Ü–∏–∏', true, '–†–µ–∂–∏–º —Å–ª—É—á–∞–π–Ω—ã—Ö –∞–Ω–∏–º–∞—Ü–∏–π –≤–∫–ª—é—á–µ–Ω');
            } catch (error) {
                addTestResult('Random –∞–Ω–∏–º–∞—Ü–∏–∏', false, error.message);
            }
        }

        // –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function runDiagnostics() {
            console.log('=== –ó–∞–ø—É—Å–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ ===');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º ContentLoader
            const hasContentLoader = checkContentLoader();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º DOM —ç–ª–µ–º–µ–Ω—Ç—ã
            const container = document.getElementById('content-container');
            addTestResult('content-container', !!container, container ? '–≠–ª–µ–º–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω' : '–≠–ª–µ–º–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
            
            const navLinks = document.querySelectorAll('.sidebar-nav a');
            addTestResult('–ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Å—ã–ª–∫–∏', navLinks.length > 0, `–ù–∞–π–¥–µ–Ω–æ ${navLinks.length} —Å—Å—ã–ª–æ–∫`);
            
            const accordions = document.querySelectorAll('.codex-btn');
            addTestResult('–ê–∫–∫–æ—Ä–¥–µ–æ–Ω—ã', accordions.length > 0, `–ù–∞–π–¥–µ–Ω–æ ${accordions.length} –∞–∫–∫–æ—Ä–¥–µ–æ–Ω–æ–≤`);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–∞–π–ª—ã
            checkFileExists('partials/main.html');
            checkFileExists('partials/core/1_intro.html');
            checkFileExists('partials/heroes/1_char.html');
            
            console.log('=== –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ===');
        }

        async function checkFileExists(url) {
            try {
                const response = await fetch(url);
                addTestResult(`–§–∞–π–ª: ${url}`, response.ok, `–°—Ç–∞—Ç—É—Å: ${response.status}`);
            } catch (error) {
                addTestResult(`–§–∞–π–ª: ${url}`, false, `–û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        function showDebugInfo() {
            if (!checkContentLoader()) return;
            window.ContentLoader.debug();
            addTestResult('Debug –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', true, '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤—ã–≤–µ–¥–µ–Ω–∞ –≤ –∫–æ–Ω—Å–æ–ª—å');
        }

        function reloadCurrentPage() {
            if (!checkContentLoader()) return;
            try {
                window.ContentLoader.reload();
                addTestResult('–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞', true, '–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            } catch (error) {
                addTestResult('–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞', false, error.message);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(() => {
                console.log('üß™ –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                checkContentLoader();
            }, 1000);
        });
    </script>
</body>
</html>