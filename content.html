<!DOCTYPE html>
<html lang="ru">
<head>
    <!-- Мета-данные -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Codex RPG | Правила игры</title>
    
    <!-- Стили -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    
    <!-- Встроенные стили -->
    <style>
        /* Контейнер для правил */
        .rules-content {
            max-width: 800px; /* Ограничение ширины */
            margin: 0 auto; /* Центрирование */
            padding: 20px; /* Внутренние отступы */
            transition: opacity 0.3s ease; /* Плавное появление */
        }
        
        /* Заголовки в контенте */
        .rules-content h2 {
            color: #2c3e50; /* Цвет текста */
            border-bottom: 2px solid #3498db; /* Подчеркивание */
            padding-bottom: 10px; /* Отступ */
            margin-top: 30px; /* Отступ сверху */
        }
        
        /* Индикатор загрузки */
        .loading-spinner {
            text-align: center; /* Центрирование */
            padding: 50px; /* Отступы */
            color: #3498db; /* Цвет */
            font-size: 1.2rem; /* Размер текста */
        }
    </style>
</head>
<body>
    <!-- Анимация перехода -->
    <div class="page-transition" id="pageTransition"></div>

    <!-- Боковая панель -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Codex</h2> <!-- Логотип -->
        </div>
        
        <!-- Основная навигация -->
        <nav class="sidebar-nav">
            <a href="index.html">Главная</a>
            <a href="content.html" class="active">Правила</a>
            <a href="about.html">О проекте</a>
            <a href="contact.html">Контакты</a>
        </nav>
        
        <!-- Блок с версиями правил -->
        <div class="sidebar-version-selectors">
            <!-- Категория правил -->
            <div class="version-selector">
                <button class="version-btn">
                    Codex of Heroes 
                    <i class="fas fa-caret-down"></i> <!-- Иконка -->
                </button>
                <div class="version-content">
                    <a href="#" data-section="heroes" data-rule="introduction">Введение</a>
                    <a href="#" data-section="heroes" data-rule="gameplay">Геймплей</a>
                </div>
            </div>
        </div>
    </aside>

    <!-- Основной контент -->
    <main class="main-content">
        <div id="content-container">
            <h1>Правила Codex</h1>
            <p>Выберите раздел в боковом меню</p>
        </div>
    </main>

    <!-- Основной скрипт -->
    <script src="script.js"></script>
    
    <!-- Скрипт загрузки правил -->
    <script>
        // Кэш загруженных правил
        const rulesCache = {};
        
        // Функция загрузки контента
        async function loadRulesContent(section, rule) {
            const container = document.getElementById('content-container');
            const cacheKey = `${section}/${rule}`;
            
            // Проверка кэша
            if (rulesCache[cacheKey]) {
                container.innerHTML = rulesCache[cacheKey];
                return;
            }
            
            // Показываем загрузку
            container.innerHTML = `
                <div class="loading-spinner">
                    <i class="fas fa-spinner fa-spin"></i> Загрузка...
                </div>
            `;
            
            try {
                // Загрузка с сервера
                const response = await fetch(`rules/${section}/${rule}.html`);
                if (!response.ok) throw new Error();
                
                const content = await response.text();
                
                // Формируем HTML
                const html = `
                    <div class="rules-content">
                        <a href="#" onclick="loadDefaultContent()" class="back-button">
                            <i class="fas fa-arrow-left"></i> Назад
                        </a>
                        ${content}
                    </div>
                `;
                
                // Кэшируем и показываем
                rulesCache[cacheKey] = html;
                container.innerHTML = html;
                
            } catch {
                // Обработка ошибок
                container.innerHTML = `
                    <div class="error">
                        Ошибка загрузки. Попробуйте позже.
                    </div>
                `;
            }
        }
        
        // Загрузка начального состояния
        function loadDefaultContent() {
            document.getElementById('content-container').innerHTML = `
                <h1>Правила Codex</h1>
                <p>Выберите раздел в боковом меню</p>
            `;
        }
        
        // Инициализация после загрузки DOM
        document.addEventListener('DOMContentLoaded', () => {
            // Обработчики для меню
            document.querySelectorAll('.version-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    btn.classList.toggle('active');
                    btn.nextElementSibling.classList.toggle('show');
                });
            });
            
            // Обработчики для ссылок на правила
            document.querySelectorAll('.version-content a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    loadRulesContent(
                        link.dataset.section, 
                        link.dataset.rule
                    );
                });
            });
        });
    </script>
</body>
</html>