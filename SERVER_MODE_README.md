# Переключение между серверным и локальным режимами

## Текущий статус
Сейчас система работает в **серверном режиме** - все данные сохраняются на сервере в папке `data/`.

## Серверный режим (рекомендуется)

### Преимущества:
- ✅ Данные сохраняются на сервере
- ✅ Возможность работы с нескольких устройств
- ✅ Более безопасное хранение паролей
- ✅ Централизованное управление пользователями

### Запуск:
1. Установите зависимости:
   ```bash
   npm install
   ```

2. Запустите сервер:
   ```bash
   npm start
   # или
   node server.js
   # или двойной клик по start-server.bat
   ```

3. Откройте в браузере:
   ```
   http://localhost:3000
   ```

### Используемые файлы:
- `auth.html` - страница авторизации
- `js/auth.js` - клиентская логика
- `server.js` - серверная часть
- `content.html` - должен использовать `js/auth.js`

## Локальный режим (для GitHub Pages)

### Преимущества:
- ✅ Работает без сервера
- ✅ Можно разместить на GitHub Pages
- ✅ Не требует установки Node.js

### Недостатки:
- ❌ Данные хранятся только в браузере
- ❌ При очистке браузера данные теряются
- ❌ Нельзя использовать с разных устройств

### Переключение на локальный режим:
1. В файле `content.html` измените:
   ```html
   <!-- Было: -->
   <script src="js/auth.js"></script>
   
   <!-- Стало: -->
   <script src="js/auth-local.js"></script>
   ```

2. Используйте `auth-local.html` вместо `auth.html` для входа

### Используемые файлы:
- `auth-local.html` - страница авторизации
- `js/auth-local.js` - вся логика в браузере
- `content.html` - должен использовать `js/auth-local.js`

## Структура данных

### Серверный режим:
```
data/
├── users.json      # Пользователи
├── events.json     # События
└── sessions.json   # Сессии
```

### Локальный режим:
Все данные в localStorage:
- `codex_users` - пользователи
- `codex_events` - события
- `codex_currentUser` - текущий пользователь
- `codex_loginTime` - время входа

## API эндпоинты (серверный режим)

- `POST /api/register` - Регистрация
- `POST /api/login` - Авторизация
- `POST /api/logout` - Выход
- `GET /api/user` - Информация о пользователе
- `GET /api/events` - Получение событий
- `POST /api/events` - Создание события
- `PUT /api/events/:id` - Обновление события
- `DELETE /api/events/:id` - Удаление события

## Безопасность

### Серверный режим:
- Пароли хешируются с помощью SHA256
- Токены сессий генерируются криптографически безопасно
- Сессии истекают через 7 дней
- Автоматическая очистка просроченных сессий

### Локальный режим:
- Простое хеширование для localStorage
- Роли: super_admin, admin, moderator, user
- Администратор по умолчанию: admin/admin123

## Переход с локального режима на серверный

1. Экспортируйте данные из браузера (если нужно)
2. Запустите сервер
3. Переключите `content.html` на использование `js/auth.js`
4. Зарегистрируйте пользователей заново

## Рекомендации

Для production используйте серверный режим с:
- HTTPS соединением
- Более сложным хешированием паролей (bcrypt)
- База данных вместо JSON файлов
- Резервное копирование данных
